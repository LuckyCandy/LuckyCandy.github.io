## 架构评估

### 1.质量属性
质量属性具有以下特征：
* 质量属性时非功能性需求，并不被功能所决定；
* 不同的项目关注的质量属性不同；
* 质量属性之间可能相互抑制；

下面时质量属性的种类：

<img src="/assets/imgs/architect/framework/质量属性.png">

**质量场景：**是一种面向特定的质量属性的需求。有以下6个组成部分：
* 刺激源，刺激来源；
* 刺激；
* 制品，系统被刺激的部分；
* 环境，刺激发生时，系统所处状态；
* 响应，刺激产生的结果；
* 响应度量标准，如何评估响应

<img src="/assets/imgs/architect/framework/质量属性场景.png">

#### 1.1 可用性
<mark>系统正常运行的事件比例，出现故障多久才启用备用系统</mark>。如下表所示：

<img src="/assets/imgs/architect/framework/可用性计算.png">

*计算举例：(365 - 36.5)/365 = 90%*

**提升可用性的策略：**
1. **心跳检测：**被监控的组件定期向监控组件发出心跳消息。若连续未收到心跳信号，则表示相应的系统已经出现了故障；
2. **表决：**多个冗余组件，用统一或不同的算法来完成一个任务，如果计算结果不同，则表决（少数服从多数）决定；
3. **主动冗余：**一个服务启动多个实例，状态时刻保持一致，平时只使用A，当A出现故障后，系统迅速切换的B；
4. **被动冗余：**服务A完成运算后，在一定时间内通知B更新；
5. **重新同步：**主动冗余和被动冗余都需要在重新上线前做状态同步；
6. **定期保存：**多设立检查点，便于故障恢复

#### 1.2 性能

**提升性能的策略：**
1. **减少处理事件时对资源的占用**，比如采取改进算法，减少计算的开销
2. **减少处理事件的数量**，可控制事件到来的速率，控制采样频率等
3. **控制资源的使用**，比如限制执行时间，限制队列大小等
4. **并发机制**，采用多核多线程每提高运算效率
5. **增加资源数量**，比如计算资源、存储资源、带宽资源等
6. **采取先来先服务的策略，或者固定优先级、动态优先（轮转调度）**

#### 1.3 可修改性
<mark>能够快速的一较高的性价比对系统进行变更的能力</mark>。

**提升可修改性的策略：**
1. **局部化修改**。程序设计高内聚低耦合，修改程序控制在一个模块内；预测变更等
2. **防止连锁反应**。<br/>
    1）信息隐藏：利用面型对象的可访问性（Public、Protected、Private）<br/>
    2）维持现有接口：接口不变的情况下，双方都能独立变化<br/>
    3）限制通信路径：使用Facade模式，设计统一门面接口<br/>
    4）使用中介：数据中介（仓库）、服务中介（桥接模式、工厂方法、代理模式等）
3. **推迟绑定时间**。<br/>
    1）运行时注册：即插即用。<br/>
    2）多态：动态绑定<br/>
    3）配置文件：配置文件来避免修改代码


#### 1.4 安全性

<mark>系统向合法用户提供服务并阻止非法用户的能力</mark>。

**提升安全性的策略：**
1. **抵抗攻击**。<br/>
    1）限制访问：设置黑、白名单<br/>
    2）限制暴露：关闭无用端口、自启动服务、无线路由SSID等<br/>
    3）维护数据机密性：给数据传输过程加密；<br/>
    4）维护数据完整性：MD5校验码<br/>
    5）用户身份验证：动态密码、一次性密码、生物识别<br/>
    6）用户授权：对用户访问进行控制管理
2. **检测攻击**。<br/>
    1）入侵检测系统
2. **从攻击中恢复**。<br/>
    1）恢复状态：设置恢复检查点<br/>
    2）识别攻击者：用于预防或惩罚性目的

### 2.质量特性

常用的4种质量特性如下：

<img src="/assets/imgs/architect/framework/质量特性.png">

### 3.架构评估方法
业界已开发出多种软件架构评估的方法，按基于技术的手段开看，可以分为以下三类：
1. **基于问卷调查或检查表的方式：**<br/>
    该方式的关键是要设计好问卷或检查表，它充分利用系统相关人员的经验和知识，获得对架构的评估；在很大程度上依赖评估人员的主管推断。

2. **基于场景的方式：**<br>
    主要包括：<br/><mark>架构权衡分析法（Architecture Tradeoff Analysis Method，ATAM）</mark><br/><mark>软件架构分析方法（Sofeware Architecture Analysis Method，SAAM）</mark><br/><mark>成本收益分析方法CBAM（Cost Benifit Analysis Method）</mark>

3. **基于度量的方式：**<br/>
    制定一些定量值来度量架构，如代码行数等。要制定质量属性和度量结果之间的映射。

**SAAM方法**<br/>
主要输入是<mark>问题描述</mark>、<mark>需求说明</mark>和<mark>架构描述</mark>，其分析过程主要包括<mark>场景开发</mark>、<mark>架构描述</mark>、<mark>单个场景评估</mark>、<mark>场景交互</mark>和<mark>总体评估</mark>。

<img src="/assets/imgs/architect/framework/SAAM.png">

**ATAM方法**<br/>
架构权衡分析方法主要在系统开发之前，针对<mark>性能</mark>、<mark>可用性</mark>、<mark>安全性</mark>和<mark>可修改性</mark>等<mark>质量属性</mark>进行<mark>评价和折衷</mark>。

ATAM可以分为4个主要的活动阶段，包括<mark>需求收集</mark>、<mark>架构视图描述</mark>、<mark>属性模型构造和分析</mark>、<mark>架构决策与折衷</mark>，整个评估过程强调以<mark>属性</mark>作为架构评估的核心概念。

以前的ATAM：

<img src="/assets/imgs/architect/framework/ATAM1.png">

现在的ATAM：

<img src="/assets/imgs/architect/framework/ATAM2.png">

**ATAM参与评估的身份：**
* 评估小组：组织内部或外部、扮演特定的角色；
* 项目决策者：项目管理人员、重要客户代表、架构师
* 项目干系人：模块开发人员、测试人员、用户

**CMAM方法：**<br/>
用来对架构设计决策的成本和收益进行建模，他的基本思想是架构策略影响系统的质量属性，反过来这些质量属性又会成为系统的项目干系人带来一些收益（称为效用），CBAM协助项目干系人根据其投资收益选择架构策略。

CBAM可以看作是ATAM的补充，在ATAM评估结果基础上对架构的经济性进行评估。