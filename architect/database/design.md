## 数据库设计

@info 数据库设计的4个阶段：<mark>需求分析、概念结构设计、逻辑结构设计、物理设计</mark>

<img src="/assets/imgs/architect/database/数据库设计.png">

### 1.需求分析

需求分析阶段，采取自顶向下，逐步分解的方式进行。采用<mark>数据流图</mark>进行图形化描述。

### 2.概念结构设计

概念设计的流程：
1. 先确定局部视图范围；
2. 在局部范围内，识别实体及其标识；
3. 确定实体之间的关系;
4. 分配实体以及联系属性。

通过上面的步骤可以看出，概念设计其实就是从产出<mark>局部E-R图</mark>，然后<mark>确定实体以及实体间的关系</mark>，到最终产出<mark>全局E-R图设计</mark>的流程。

将局部E-R图合并为全局E-R图时可能会产生以下冲突：

|名词|解释|
|-|-|
|属性冲突|<mark>属性域冲突，属性类型不一致</mark>，比如：有的部门将零件号定义为整数，有的定义为字符串|
||<mark>属性值冲突，数值代表含义不同</mark>，比如：有的以分钟为单位，有的以秒为单位|
|结构冲突|同一对象在不同应用中额<mark>抽象不同</mark>，有可能在A应用中是实体，在B应用中为属性|
||同一实体在不同E-R图中<mark>属性个数</mark>和<mark>排列次序</mark>不同|
|命名冲突|<mark>同名异义或异名同义</mark>|

### 3.逻辑结构设计

逻辑结构设计也称为逻辑设计，其任务是将概念模型转化为关系模型。

E-R图像关系模型的转换规则如下：
1. E-R图的实体转换为关系；
2. E-R图的属性转换为关系的属性；
3. E-R图的关键字转换称关系的关键字（主键）；

其他特殊属性的转换：

* **复合属性：**比如出生日期包括年、月、日等。这种属性转换有两种方式：
    1. 删除复合属性，将复合属性的每个分量属性直接作为实体的属性；
    2. 不做处理，直接将复合属性当作实体属性处理。

* **多值属性：**一个属性有多种值，这种属性的转换有两种方式：
    1. 将多值属性与实体的主键组合，形成新的关系（比较常用）；
    2. 将多值属性提升为一个弱实体(弱实体只能依靠实体存在)

* **派生属性：**可由其他属性计算得到，比如根据出生日期计算出年龄。此种属性一般不转换。

* **BLOB属性：**图片或声音文件，采用BLOB的方式处理就可以让数据库把这种类型的文件统一处理，而不用在乎它到底是何种文件。这种属性的转换一般采取与实体的主键单独形成新的关系模式。

* **联系的属性：**实体之间的关系的转换，一般需要单独与实体间的主键形成关系模式，或者也可以与任意（1:n的关系要放到n端）一端对应的关系模式合并（n:m的联系以及多元联系只能采用前者）。

### 4.真题
---
<img src="/assets/imgs/architect/database/数据库设计真题png.png">

[解：]{color:red;font-weight:bold}
1. 冲突产生于从局部视图到全局E-R图转换过程中出现，主要有三种冲突：结构冲突、命名冲突、属性冲突。因此优先排除D选项；<br/>职工和教师本质是一个实体，属性个数和排列均不同，所以应该为结构冲突（命名冲突应该在没有结构冲突的前提时再判断）
2. 相同实体，结构冲突，只需要合并实体，删除重复项即可，因此选项 B 正确。